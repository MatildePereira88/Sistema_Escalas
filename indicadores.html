<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Indicadores - Sistema de Escalas</title>
    <style>
        :root {
            --cor-fundo: #f4f7f6; --cor-card-fundo: #ffffff; --cor-texto-primario: #1a202c;
            --cor-texto-secundario: #718096; --cor-borda: #e2e8f0; --cor-header-fundo: #1a202c;
            --cor-header-texto: #f7fafc; --cor-header-borda: #2d3748; --cor-primaria: #000000;
            --cor-secundaria: #D4B344; --cor-alerta-vermelho: #e53e3e; --cor-alerta-amarelo: #dd6b20;
            --cor-azul-grafico: #4299e1;
        }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background-color: var(--cor-fundo); color: var(--cor-texto-primario); margin: 0; }
        .container { max-width: 1400px; margin: 30px auto; padding: 0 20px; }
        .card { background-color: var(--cor-card-fundo); padding: 25px; border-radius: 8px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06); border: 1px solid var(--cor-borda); }
        .section-title { font-size: 1.5em; color: var(--cor-texto-primario); border-bottom: 1px solid var(--cor-borda); padding-bottom: 10px; margin-top: 40px; margin-bottom: 20px; font-weight: 600; }
        #loading-stats { padding: 30px; text-align: center; color: var(--cor-texto-secundario); font-size: 1.1em; }
        .main-header { background-color: var(--cor-header-fundo); padding: 10px 30px; }
        .main-header .header-content { display: flex; align-items: center; justify-content: space-between; max-width: 1400px; margin: 0 auto; }
        .main-header .header-title-group { display: flex; align-items: center; gap: 15px; }
        .main-header .logo { height: 40px; }
        .main-header h1 { color: var(--cor-header-texto); font-size: 1.4em; }
        .btn-voltar-header { display: inline-block; padding: 8px 18px; background-color: transparent; color: #9ca3af; text-decoration: none; font-weight: 500; border-radius: 6px; border: 1px solid var(--cor-header-borda); transition: all 0.2s; }
        .btn-voltar-header:hover { background-color: var(--cor-secundaria); color: var(--cor-primaria); border-color: var(--cor-secundaria); }
        .filters-container { display: flex; flex-wrap: wrap; gap: 16px; align-items: flex-end; }
        .filter-group { flex: 1; min-width: 160px; }
        .filter-group label { font-size: 0.8em; font-weight: 600; color: var(--cor-texto-secundario); display: block; margin-bottom: 4px; }
        .filter-group input, .filter-group select { width: 100%; box-sizing: border-box; padding: 10px; border-radius: 6px; border: 1px solid var(--cor-borda); }
        .filters-container button { padding: 10px 25px; border-radius: 6px; border: none; background-color: var(--cor-secundaria); color: var(--cor-primaria); cursor: pointer; font-weight: 600; height: 42px; }
        .kpi-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; } /* Ajuste no minmax */
        .kpi-card { padding: 20px; text-align: center; }
        .kpi-value { font-size: 2.5em; font-weight: 700; color: var(--cor-azul-grafico); }
        .kpi-label { font-size: 0.9em; color: var(--cor-texto-secundario); margin-top: 5px; font-weight: 500; }
        .kpi-detail { font-size: 0.8em; color: var(--cor-texto-secundario); margin-top: 10px; line-height: 1.4; }
        /* NOVO: Estilo para o tooltip de detalhes */
        .kpi-card .kpi-detail.hover-info {
            cursor: pointer; /* Mudado de help para pointer para indicar clique */
            text-decoration: underline dotted;
        }
        .analysis-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px; margin-top: 20px; }
        .table-card { display: flex; flex-direction: column; }
        .table-card h3 { margin-top: 0; font-size: 1.1em; display: flex; align-items: center; gap: 10px; }
        .table-wrapper { flex-grow: 1; overflow-y: auto; max-height: 350px; }
        .table-wrapper.no-limit { max-height: none; overflow-y: visible; }
        .data-table { width: 100%; border-collapse: collapse; }
        .data-table th, .data-table td { padding: 10px; text-align: left; border-bottom: 1px solid var(--cor-borda); font-size: 0.9em; }
        .data-table thead th { background-color: #f9fafb; position: sticky; top: 0; font-size: 0.85em; }
        .alert-dot { height: 10px; width: 10px; border-radius: 50%; flex-shrink: 0; }
        .alert-dot.red { background-color: var(--cor-alerta-vermelho); }
        .alert-dot.yellow { background-color: var(--cor-alerta-amarelo); }
        .drill-down-action { color: var(--cor-azul-grafico); text-decoration: underline; cursor: pointer; font-weight: 600; }
    </style>
</head>
<body>
    <header class="main-header">
        <div class="header-content">
            <div class="header-title-group"><img src="assets/img/logo.png" alt="Logo" class="logo"><h1>Dashboard Estratégico</h1></div>
            <a href="/painel-adm.html" class="btn-voltar-header">Voltar ao Painel</a>
        </div>
    </header>

    <main class="container">
        <div class="filters-container card">
            <div class="filter-group"><label for="filtro-data-inicio">Analisar Período De</label><input type="date" id="filtro-data-inicio"></div>
            <div class="filter-group"><label for="filtro-data-fim">Até</label><input type="date" id="filtro-data-fim"></div>
            <div class="filter-group"><label for="filtro-loja">Loja</label><select id="filtro-loja"><option value="">Todas</option></select></div>
            <div class="filter-group" id="container-filtro-supervisor"><label for="filtro-supervisor">Supervisor</label><select id="filtro-supervisor"><option value="">Todos</option></select></div>
            <button id="btn-aplicar-filtros">Analisar</button>
        </div>

        <div id="loading-stats">Selecione um período para iniciar a análise...</div>

        <div id="stats-wrapper" style="display: none;">
            <div class="kpi-grid">
                <div class="kpi-card card">
                    <div class="kpi-value" id="kpi-total-lojas">0</div>
                    <div class="kpi-label">Lojas na Análise</div>
                    <div class="kpi-detail" id="kpi-detalhe-lojas-regiao"></div>
                </div>

                <div class="kpi-card card">
                    <div class="kpi-value" id="kpi-total-colaboradores">0</div>
                    <div class="kpi-label">Colaboradores Ativos</div>
                    <div class="kpi-detail" id="kpi-detalhe-cargos"></div>
                </div>

                <div class="kpi-card card">
                    <div class="kpi-value" id="kpi-total-ferias">0</div>
                    <div class="kpi-label">Colaboradores em Férias</div>
                    <div class="kpi-detail hover-info" id="kpi-detalhe-ferias-cargo"></div>
                </div>
                
                <div class="kpi-card card">
                    <div class="kpi-value" id="kpi-total-atestados">0</div>
                    <div class="kpi-label">Colaboradores com Atestado</div>
                    <div class="kpi-detail hover-info" id="kpi-detalhe-atestados-cargo"></div>
                </div>

                <div class="kpi-card card">
                    <div class="kpi-value" id="kpi-total-compensacao">0</div>
                    <div class="kpi-label">Colaboradores em Compensação</div>
                    <div class="kpi-detail hover-info" id="kpi-detalhe-compensacao-cargo"></div>
                </div>

                <div class="kpi-card card">
                    <div class="kpi-value" id="kpi-disponibilidade-equipe">0%</div>
                    <div class="kpi-label">Disponibilidade da Equipe</div>
                    <div class="kpi-detail">Com base em ausências por atestado.</div>
                </div>
            </div>

            <div class="analysis-grid">
                </div>

            <h2 class="section-title">Painel de Ação e Risco</h2>
            <div class="analysis-grid">
                 <div class="table-card card">
                     <h3><span class="alert-dot red"></span>Escalas Pendentes</h3>
                     <div class="table-wrapper no-limit"><table class="data-table"><thead><tr><th>Loja</th><th>Período Pendente</th></tr></thead><tbody id="tabela-escalas-faltantes"></tbody></table></div>
                 </div>
                 <div class="table-card card">
                     <h3><span class="alert-dot yellow"></span>Alertas de Cobertura de Liderança</h3>
                     <div class="table-wrapper no-limit"><table class="data-table"><thead><tr><th>Data</th><th>Risco Detetado</th><th>Ação</th></tr></thead><tbody id="tabela-alertas-lideranca"></tbody></table></div>
                 </div>
            </div>
        </div>
    </main>
    <script src="assets/js/modal.js"></script>
    <script src="assets/js/indicadores.js"></script>
</body>
</html>
